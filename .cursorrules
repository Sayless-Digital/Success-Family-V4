# Success Family Platform - Cursor Rules

## ğŸš¨ MANDATORY PRE-ANALYSIS REQUIREMENTS

Before making ANY change, you MUST:

1. **Analyze the exact codebase architecture** by examining:
   - File structure in `src/` directory
   - Import patterns and dependencies
   - Existing component implementations
   - Configuration files (tailwind.config.ts, components.json, tsconfig.json)
   - Environment setup (src/lib/env.ts, .env structure)

2. **Trace all dependencies** for any component or function you're modifying:
   - Check `src/lib/` utilities and their usage patterns
   - Verify Supabase client configurations (src/lib/supabase.ts, src/lib/supabase-server.ts)
   - Examine existing TypeScript types in `src/types/`
   - Review middleware implementation in `src/middleware.ts`

3. **Understand the specific implementation context**:
   - This is a Next.js 16 App Router project with Turbopack
   - Uses Tailwind CSS v4.1.16 with @tailwindcss/postcss plugin
   - Implements shadcn/ui components with class-variance-authority
   - Uses Supabase for database, auth, and storage
   - Includes Resend API for email functionality
   - Environment variables are validated through src/lib/env.ts

## ğŸ¯ ARCHITECTURAL PATTERNS TO FOLLOW

### File Structure Conventions
```
src/
â”œâ”€â”€ app/                    # Next.js App Router (pages, layouts, globals.css)
â”œâ”€â”€ components/
â”‚   â””â”€â”€ ui/                # shadcn/ui components ONLY
â”œâ”€â”€ lib/                   # Utility functions and configurations
â”‚   â”œâ”€â”€ env.ts            # Environment validation (MANDATORY to use)
â”‚   â”œâ”€â”€ supabase.ts       # Client-side Supabase
â”‚   â”œâ”€â”€ supabase-server.ts # Server-side Supabase
â”‚   â”œâ”€â”€ utils.ts          # cn() utility for class merging
â”‚   â””â”€â”€ email.ts          # Resend email functionality
â”œâ”€â”€ types/                 # TypeScript definitions
â””â”€â”€ middleware.ts          # Supabase auth middleware
```

### Component Development Rules

1. **ALWAYS use shadcn/ui components** from `src/components/ui/`
   - Import pattern: `import { Button } from "@/components/ui/button"`
   - Use existing variants and props, don't create custom ones
   - Extend with `className` prop using `cn()` utility

2. **ALWAYS use global styles** from `src/app/globals.css`
   - Use CSS custom properties: `hsl(var(--primary))`
   - Leverage the established color system
   - Maintain dark/light mode compatibility

3. **ALWAYS use validated environment variables**:
   ```typescript
   import { env } from '@/lib/env'
   // Use env.NEXT_PUBLIC_SUPABASE_URL, not process.env directly
   ```

4. **ALWAYS use the cn() utility** for className merging:
   ```typescript
   import { cn } from '@/lib/utils'
   className={cn("base-classes", conditionalClasses, className)}
   ```

### Supabase Integration Patterns

1. **Client-side operations**: Use `src/lib/supabase.ts`
   ```typescript
   import { supabase } from '@/lib/supabase'
   ```

2. **Server-side operations**: Use `src/lib/supabase-server.ts`
   ```typescript
   import { createServerSupabaseClient } from '@/lib/supabase-server'
   const supabase = await createServerSupabaseClient()
   ```

3. **Type safety**: Use types from `src/types/index.ts`
   ```typescript
   import { User, Community, Post } from '@/types'
   ```

### Styling and UI Rules

1. **Tailwind CSS v4 patterns**:
   - Use CSS custom properties for theming
   - Leverage the established color palette
   - Use `@layer base` for global styles
   - Maintain responsive design patterns

2. **shadcn/ui component patterns**:
   - Use `class-variance-authority` for variant management
   - Implement proper TypeScript interfaces
   - Use `React.forwardRef` for ref forwarding
   - Export both component and variants

3. **Global style integration**:
   - Always import `src/app/globals.css` in layout
   - Use established CSS custom properties
   - Maintain consistency with existing design system

## ğŸ” MANDATORY ANALYSIS CHECKLIST

Before implementing any change, verify:

- [ ] **File structure**: Does this follow the established `src/` organization?
- [ ] **Import patterns**: Are imports using the correct `@/` alias?
- [ ] **Component usage**: Am I using existing shadcn/ui components?
- [ ] **Styling approach**: Am I using global styles and CSS custom properties?
- [ ] **Environment variables**: Am I using `env` from `src/lib/env.ts`?
- [ ] **Type safety**: Am I using types from `src/types/`?
- [ ] **Supabase integration**: Am I using the correct client (client vs server)?
- [ ] **Utility functions**: Am I using `cn()` for className merging?

## ğŸš« FORBIDDEN PATTERNS

1. **NEVER** use `process.env` directly - always use `env` from `src/lib/env.ts`
2. **NEVER** create custom UI components when shadcn/ui equivalents exist
3. **NEVER** use hardcoded colors - always use CSS custom properties
4. **NEVER** bypass the established file structure
5. **NEVER** create duplicate utility functions
6. **NEVER** use different Supabase client patterns than established ones

## ğŸ“‹ IMPLEMENTATION WORKFLOW

1. **Analyze existing code** in the target area
2. **Check for existing patterns** in similar components
3. **Verify dependencies** and import requirements
4. **Use established utilities** (cn, env, supabase clients)
5. **Follow naming conventions** from existing code
6. **Test with existing build system** (pnpm dev, pnpm build)
7. **Maintain type safety** throughout

## ğŸ¨ DESIGN SYSTEM REQUIREMENTS

- **Colors**: Use CSS custom properties from `globals.css`
- **Typography**: Use Inter font from `layout.tsx`
- **Spacing**: Follow Tailwind spacing scale
- **Components**: Use shadcn/ui variants and patterns
- **Responsive**: Mobile-first approach with Tailwind breakpoints
- **Accessibility**: Maintain ARIA patterns from shadcn/ui

## ğŸ”§ DEVELOPMENT COMMANDS

- `pnpm dev` - Development with Turbopack
- `pnpm build` - Production build
- `pnpm lint` - ESLint checking
- `pnpm start` - Production server

## ğŸ“š CRITICAL DOCUMENTATION

- **Setup**: See `SETUP.md` for environment configuration
- **Architecture**: See `README.md` for project overview
- **Components**: See `components.json` for shadcn/ui config
- **Styling**: See `tailwind.config.ts` for theme configuration

---

**REMEMBER**: This codebase has specific architectural decisions and patterns. Always analyze the existing implementation before making changes. Do not assume standard patterns - verify the actual implementation in this specific project.
